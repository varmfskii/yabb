10 PRINTCHR$(125);
11 GOSUB110
12 GOSUB1005
20 GOSUB410
21 GOSUB510
22 END
100 REM *** INIT
110 SC=100
111 READTC
112 L=65537
120 DIMC(TC),S(12),Q$(36),TN$(12)
130 DIMTP$(40),C$(10),R$(10)
140 FORI=1TO12
141 S(I)=I
142 NEXTI
143 X=1
150 Q$="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890"
160 RETURN
200 REM *** RESET TIMER
210 POKE18,0
211 POKE19,0
212 POKE20,0
213 TM=0
214 RETURN
300 REM *** GET TIME
310 TM=(PEEK(19)*256+PEEK(20))/60
311 RETURN
400 REM *** RUN TESTS
410 FORT=1TOTC
411 READTN$,TR
420 PRINTCHR$(125);
421 PRINTTN$;":"
430 ONT GOSUB1110,1210,1310,1410,1510,1610,1710,1810
440 TM=TM-C*CC/CA-C/CB
450 C(T)=C*CC/TM
451 NEXTT
452 RETURN
500 REM *** RESULTS
510 PRINTCHR$(125);
511 RESTORE
512 READTC
520 PRINT"RESULTS"
521 RA=1
530 FORT=1TOTC
531 READTN$,TR
540 RT=C(T)/TR
541 RA=RA*RT
550 TP$=TN$
551 TP$(LEN(TP$)+1)=":       "
552 PRINTTP$(1,8);
560 TP$="     "
561 TP$(6)=STR$(INT(C(T)*100+.5)/100+.001)
570 LL=LEN(TP$)
571 C$=TP$(LL-8,LL-1)
580 TP$="     "
581 TP$(6)=STR$(INT(100*RT+.5))
590 LL=LEN(TP$)
591 R$=TP$(LL-5,LL)
600 PRINTC$;" ";R$;"%"
610 NEXTT
611 RA=RA^(1/TC)
620 PRINT"SUMMARY:         ";
630 TP$="     "
631 TP$(6)=STR$(INT(100*RA+.5))
640 LL=LEN(TP$)
641 R$=TP$(LL-5,LL)
650 PRINTR$;"%"
651 RETURN
1000 REM *** CALIBRATE
1005 PRINTCHR$(125);
1006 PRINT"CALIBRATE 1:"
1007 C=0
1010 H=L+1023
1011 GOSUB210
1015 C=C+1
1016 POSITION14,0
1017 PRINTTM
1020 FORI=L TOH
1025 NEXTI
1026 GOSUB310
1030 IFTM<SC THEN1015
1035 C1=TM/C
1040 PRINTCHR$(125);
1041 PRINT"CALIBRATE 2:"
1042 C=0
1045 H=L+511
1046 GOSUB210
1050 C=C+1
1051 POSITION14,0
1052 PRINTTM
1055 FORI=L TOH
1060 NEXTI
1061 GOSUB310
1065 IFTM<SC THEN1050
1070 C2=TM/C
1071 CA=512/(C1-C2)
1075 CB=1/(2*C2-C1)
1080 CC=INT(CA/2+0.5)
1081 H=L+CC-1
1085 RETURN
1100 REM *** FOR
1110 C=0
1111 GOSUB210
1120 C=C+1
1121 POSITION14,0
1122 PRINTTM
1130 FORI=L TOH
1140 FORJ=1TO10
1141 NEXTJ
1150 NEXTI
1151 GOSUB310
1160 IFTM<SC THEN1120
1170 RETURN
1200 REM *** CONTROL
1210 C=0
1211 GOSUB210
1220 C=C+1
1221 POSITION14,0
1222 PRINTTM
1230 FORI=L TOH
1240 IFI>0THENGOSUB160
1250 NEXTI
1251 GOSUB310
1260 IFTM<SC THEN1220
1270 RETURN
1300 REM *** FN
1310 C=0
1311 GOSUB210
1320 C=C+1
1321 POSITION14,0
1322 PRINTTM
1330 FORI=L TOH
1340 X=I
1341 GOSUB9800
1342 X=M
1350 NEXTI
1351 GOSUB310
1360 IFTM<SC THEN1320
1370 RETURN
1400 REM *** MATH 1
1410 C=0
1411 GOSUB210
1420 C=C+1
1421 POSITION14,0
1422 PRINTTM
1430 FORI=L TOH
1440 X=I
1441 X=(X+X)*X/X-X
1450 NEXTI
1451 GOSUB310
1460 IFTM<SC THEN1420
1470 RETURN
1500 REM *** MATH 2
1510 C=0
1511 GOSUB210
1520 C=C+1
1521 POSITION14,0
1522 PRINTTM
1530 FORI=L TOH
1540 X=I-L
1541 X=ATN(SQR(ABS(SIN(X)/COS(X))))
1550 NEXTI
1551 GOSUB310
1560 IFTM<SC THEN1520
1570 RETURN
1600 REM *** STRING
1610 C=0
1611 GOSUB210
1620 C=C+1
1621 POSITION14,0
1622 PRINTTM
1630 FORI=L TOH
1640 TP$=Q$(2,36)
1641 TP$(36)=Q$(1)
1642 Q$=TP$
1650 NEXTI
1651 GOSUB310
1660 IFTM<SC THEN1620
1670 RETURN
1700 REM *** ARRAY
1710 C=0
1711 GOSUB210
1720 C=C+1
1721 POSITION14,0
1722 PRINTTM
1730 FORI=L TOH
1740 X=I
1741 GOSUB9800
1742 X=M
1743 S(X)=(S(X-1)+S(X)+S(X+1))/3
1750 NEXTI
1751 GOSUB310
1760 IFTM<SC THEN1720
1770 RETURN
1800 REM *** PRINT
1810 C=0
1811 GOSUB210
1820 C=C+1
1821 POSITION14,0
1822 PRINTTM
1830 FORI=L TOH
1840 POSITION0,1
1841 PRINTI;" ";
1850 NEXTI
1851 GOSUB310
1860 IFTM<SC THEN1820
1870 RETURN
9800 M=2+X-INT(X/10)*10
9801 RETURN
9900 DATA8
9910 DATAFOR,41.3,CONTROL,196
9920 DATAFN,54.4,MATH 1,74.9
9930 DATAMATH 2,6.04,STRING,72.9
9940 DATAARRAY,26.5,PRINT,73.2
